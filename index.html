<html>
<head>
  <title>Evo</title>
  <script type='text/javascript' src='lib/ivank.js'></script> 
  <script type='text/javascript' src='lib/Box2dWeb-2.1.a.3.min.js'></script> 
  <script type='text/javascript' src='src/ActorBody.js'></script>
  <script type='text/javascript' src='src/Walker.js'></script>
  <script type='text/javascript'>
    var world;
    var walker;

    function Start() {
      var stage = new Stage('c');
      stage.addEventListener(Event.ENTER_FRAME, onEF);

      // Setup box2d world.
      var b2Vec2          = Box2D.Common.Math.b2Vec2,
          b2BodyDef       = Box2D.Dynamics.b2BodyDef,
          b2Body          = Box2D.Dynamics.b2Body,
          b2FixtureDef    = Box2D.Dynamics.b2FixtureDef,
          b2World         = Box2D.Dynamics.b2World,
          b2PolygonShape  = Box2D.Collision.Shapes.b2PolygonShape,
          b2CircleShape   = Box2D.Collision.Shapes.b2CircleShape;

      world = new b2World(new b2Vec2(0, 10), true); // Gravity, doSleep 
      var bodyDef = new b2BodyDef();

      // Create the ground
      bodyDef.type = b2Body.b2_staticBody;
      var bxFixDef = new b2FixtureDef();
      bxFixDef.density = 1;
      bxFixDef.shape = new b2PolygonShape();
      bxFixDef.shape.SetAsBox(10, 1);
      bodyDef.position.Set(9, stage.stageHeight/100 + 1);

      world.CreateBody(bodyDef).CreateFixture(bxFixDef);

      // Setup walker
      bodyDef.type = b2Body.b2_dynamicBody;
      bxFixDef.shape.SetAsBox(6.4, 6.4);
      bodyDef.position.Set(5, -5);
      var body = world.CreateBody(bodyDef);
      body.CreateFixture(bxFixDef);
      walker = new Walker();
      walker.init('img/sloth.png', 64, 64, body);
      stage.addChild(walker.getSprite());
    }

    function onEF() {
      world.Step(1 / 60, 3, 3);
      world.ClearForces();

      walker.update();
    }
  </script>
<head>
<body onload='Start();'>
  <canvas id='c'></canvas>
</body>
</html>
